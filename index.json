[{"categories":null,"content":"#相关系数 cor(x,use=c(\"all.obs\",\"everything\",\"complete.obs\",\"pairwise.complete.obs\"),method=c(\"pearson\", \"kendall\", \"spearman\")) cor.test(x, y, method=c(\"pearson\", \"kendall\", \"spearman\"),alternative = c(\"two.sided\", \"less\", \"greater\")) 统计分析中常见的变量类型有连续型数值变量，无序分类变量、有序分类变量。 连续型数值变量：如销售额、气温、工资收入、考试成绩； 无序分类变量：如性别男和女，血型种类； 有序分类变量：如学历水平小学、初中、高中、大学、研究生； ##Pearson相关系数 作用：是衡量线性关联性的程度 定义：两个连续变量(X,Y)的pearson相关性系数(Px,y)等于它们之间的协方差cov(X,Y)除以它们各自标准差的乘积(σX,σY) 使用前提： 实验数据通常假设是成对的来自于正态分布的总体。由于我们在求皮尔森相关性系数以后，通常还会用t检验之类的方法来进行皮尔森相关性系数检验，而 t检验是基于数据呈正态分布的假设的。 实验数据之间的差距不能太大，或者说皮尔森相关性系数受异常值的影响比较大 两个数据序列的数据要一一对应，等间距等比例。数据序列通常来自对同一组样本的多次测量或不同视角的测量。 example: Pearson’s product-moment correlation data: data[, 2] and data[, 3] t = 13.681, df = 448, p-value \u003c 2.2e-16 alternative hypothesis: true correlation is not equal to 0 95 percent confidence interval: 0.4741850 0.6049145 sample estimates: cor 0.5428297 在上面的结果中： t是t检验统计值（t = 13.681） df是自由度（df = 448） p值是t检验的显着性水平（p-value \u003c 2.2e-16） 95CI是是相关系数在95％时的置信区间（[4741850,0.6049145） cor是相关系数（0.543） ##spearman相关系数 作用：非参数相关系数，不是衡量线性相关的，而是衡量秩序的相关性的 定义：可以理解成就是一种顺序或者排序，根据原始数据的排序位置进行求解，即依据两列成对等级的各对等级数之差来进行计算。这种表征形式就没有了求皮尔森相关性系数时那些限制 使用前提： 不服从双变量正态分布的资料； 总体分布类型未知； 两个数据序列的数据一一对应，等间距等比例。数据序列通常来自对同一组样本的多次测量或不同视角的测量。 ##kendall相关系数 作用：计算有序类别的相关系数 定义：n个同类的统计对象按特定属性排序，其他属性通常是乱序的。同序对和异序对之差与总对数（n*(n-1)/2)的比值定义为Kendall系数。 使用前提： 两个分类变量均为有序分类 当既不满足正态分布，也不是等间距的定距数据 ##总结 Pearson,Spearman和Kendall作用： Pearson积差相关系数衡量了两个定量变量之间的线性相关程度 Spearman等级相关系数则衡量分级定序变量之间的相关程度 Kenddall’s Tau相关系数也是一种非参数的等级相关度量 Pearson,Spearman和Kendall的区别： 对于一般情况默认数据服从正太分布的或两个连续变量间呈现线性相关时，使用Pearson积差相关系数 Spearman相关系数对原始变量的分布不作要求，属于非参数统计方法，相对于Pearson相关使用范围要广些，对于服从Pearson相关系数的数据也可以计算Spearman相关系数，但是效果要低一些（因为Spearman忽略了原始变量的值的大小，只看重此值在整个变量数据的名次位置） 当资料不服从双变量正态分布或总体分布型未知或原始数据时用等级表示时，宜用Spearman或Kendall相关 ##补充 来自两个变量（x，y）中每个变量的数据是否服从正态分布 使用Shapiro-Wilk正态性检验 –\u003e R函数：shapiro.test（） 画qqplot —\u003e R函数：ggpubr :: ggqqplot（） 画概率密度图 –\u003e lines(density(data$wes_TMB),col=“blue”,lwd=2) ","date":"2022-10-09","objectID":"/blog/%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0/:0:0","tags":null,"title":"相关系数","uri":"/blog/%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0/"},{"categories":null,"content":"分析报告作图（以20220908_Vazyme_data为例） ##背景介绍 针对不同样本类型（gDNA、ctDNA），采用一套建库试剂盒（ND627）， 设计方案使其同时满足 gDNA、ctDNA 的文库构建，并在性能上与 KK8514、 KK8504 一致或更优。ND627分别与不同的扩增模块在不同的打断时间下分组实验，每组实验重复三次。gDNA为ND627分别与（N616,N618）在打断时间为（37℃ 12min,65℃ 30min）的条件下建库与KK8514作为比较共三组。CtDNA为ND627分别于（N616，N618）在打断时间为（20℃ 15min，65℃ 15min/65℃ 30 min）的条件下建库与KK8504作为比较共五组。 ctdna中有8个参考突变位点，gdna中有13个参考突变位点 ##分析思路 #barplot 首先分别在ctdna和gdna样本中匹配其对应的参考突变位点，并对相应的在不同条件下的分组实验添加type列用于区分组别。(见ctDNA/gdna_match_result.txt) 在R中导入上述数据文件，运行 plot_code.R中对应代码即可按照突变位点的不同将不同组别的不同样本中匹配到的突变位点的 AF值以柱状图的形式展示 #heatmap 1.除了展示突变位点在不同样本中的 AF值，还需要按照组别以求平均值的方式绘制热图，展示不同突变位点在不同组别中的差异 2.在 barplot的 ctDNA/gdna_match_result.txt文件的基础上将文件处理为矩阵格式（见ctDNA/gdna_match_result_avg1.txt） 3.导入上述矩阵文件，运行plot_code.R中对应代码即可 ##参数 geom_bar()柱状图柱体分布参数 scale_fill_manual()柱状图分组颜色参数 theme()坐标字体参数 x/ylim横纵坐标显示数值范围参数 geom_text()柱状图数值等具体信息调整参数 geom_hline()参考线绘制参数 ","date":"2022-10-09","objectID":"/blog/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A%E4%BD%9C%E5%9B%BE%E4%BB%A520220908_vazyme_data%E4%B8%BA%E4%BE%8B/:0:0","tags":null,"title":"分析报告作图（以20220908_Vazyme_data为例）","uri":"/blog/%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A%E4%BD%9C%E5%9B%BE%E4%BB%A520220908_vazyme_data%E4%B8%BA%E4%BE%8B/"}]